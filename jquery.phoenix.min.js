(function(){!function(t,e){var n,r,i,o,s;return i="phoenix",r={namespace:"phoenixStorage",maxItems:50,saveInterval:1e3,clearOnSubmit:!1},o=[],n=function(){function n(n,o,s,a){this.element=n,this.index=o,this.action=a,this._defaults=r,this._name=i,this.$element=t(this.element),this.options=t.extend({},r,s),this.uri=e.location.host+e.location.pathname,this.storageKey=this.options.namespace+"."+this.uri+"."+this.index.toString(),this.storageIndexKey=this.options.namespace+".index."+e.location.host,this.init()}return n.prototype.indexedItems=function(){return JSON.parse(localStorage[this.storageIndexKey])},n.prototype.remove=function(){var e,n;return this.stop(),localStorage.removeItem(this.storageKey),e=t.Event("phnx.removed"),this.$element.trigger(e),n=this.indexedItems(),n.slice(t.inArray(this.storageKey,n),1),localStorage[this.storageIndexKey]=JSON.stringify(n)},n.prototype.updateIndex=function(){var e;return e=this.indexedItems(),-1===t.inArray(this.storageKey,e)?(e.push(this.storageKey),e.length>this.options.maxItems&&(localStorage.removeItem(e[0]),e.shift()),localStorage[this.storageIndexKey]=JSON.stringify(e)):void 0},n.prototype.load=function(){var e,n;return n=localStorage[this.storageKey],null!=n?(this.element.value=localStorage[this.storageKey],e=t.Event("phnx.loaded"),this.$element.trigger(e)):void 0},n.prototype.save=function(){var e;return null!=this.element.value?(localStorage[this.storageKey]=this.element.value,e=t.Event("phnx.saved"),this.$element.trigger(e),this.updateIndex()):void 0},n.prototype.start=function(){var e,n,r;return r=this,n=setInterval(function(){return r.save()},r.options.saveInterval),o.push(n),e=t.Event("phnx.started"),this.$element.trigger(e)},n.prototype.stop=function(){var e;return o.forEach(function(t){return clearInterval(t)}),e=t.Event("phnx.stopped"),this.$element.trigger(e)},n.prototype.init=function(){var e;switch(void 0===localStorage[this.storageIndexKey]&&(localStorage[this.storageIndexKey]="[]"),this.action){case"remove":return this.remove();case"start":return this.start();case"stop":return this.stop();case"load":return this.load();case"save":return this.save();default:if(this.load(),this.start(),e=this,this.options.clearOnSubmit)return t(this.options.clearOnSubmit).submit(function(){return e.remove()})}},n}(),s=function(){var t;try{return"localStorage"in e&&null!==e.localStorage}catch(n){return t=n,!1}},t.fn[i]=function(e){var r;return r="plugin_"+i,this.each(function(i){var o,a;return"object"==typeof e&&(a=e),"string"==typeof e&&(o=e),!t.data(this,r)||s()?t.data(this,r,new n(this,i,a,o)):void 0})}}(jQuery,window,document)}).call(this);